{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-service.js","../src/index.js"],"sourcesContent":["import axios from \"axios\";\n\naxios.defaults.baseURL = \"https://pixabay.com/api\";\nconst keyApi = \"24433477-a7717dfa51cf01b03daed8616\";\n\nexport default class PixabayApiService {\n  constructor() {\n    this.searchQuery = \"\";\n    this.page = 1;\n  }\n\n  async fetchImg() {\n    const getImg = await axios.get(\n      `/?key=${keyApi}&q=${this.searchQuery}&image_type=photo&orientation=horizontal&safesearch=true&per_page=40&page=${this.page}`,\n    );\n\n    this.incrementPage();\n    return getImg;\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n}\n","import PixabayApiService from \"./js/pixabay-service\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\n  searchFormEl: document.querySelector(\".search-form\"),\n  loadMoreBtnEl: document.querySelector(\".load-more\"),\n  galleryEl: document.querySelector(\".gallery\"),\n};\n\nconst pixabayApiService = new PixabayApiService();\n\nlet lightbox = new SimpleLightbox(\".gallery a\");\n\nrefs.searchFormEl.addEventListener(\"submit\", onSearch);\nrefs.loadMoreBtnEl.addEventListener(\"click\", onLoadMore);\n\nrefs.loadMoreBtnEl.classList.add(\"is-hidden\");\n\nasync function onSearch(e) {\n  e.preventDefault();\n  pixabayApiService.searchQuery = e.currentTarget.elements.searchQuery.value;\n\n  await refs.loadMoreBtnEl.classList.add(\"is-hidden\");\n\n  const hits = await pixabayApiService.fetchImg();\n  const totalHits = hits.data.totalHits;\n\n  if (totalHits < 1) {\n    refs.loadMoreBtnEl.classList.add(\"is-hidden\");\n    clearPhotoCardGallery();\n    iziToast.error({message: \"Sorry, there are no images matching your search query. Please try again.\"});\n    return;\n  }\n\n  await clearPhotoCardGallery();\n\n  await pixabayApiService.resetPage();\n  await pixabayApiService.fetchImg().then(appendPhotoCardMarkup);\n  await refs.loadMoreBtnEl.classList.remove(\"is-hidden\");\n  iziToast.success({message: `Hooray! We found ${totalHits} images.`});\n}\n\nasync function onLoadMore() {\n  await pixabayApiService.fetchImg().then(appendPhotoCardMarkup);  \n  const hits = await pixabayApiService.fetchImg();\n  const hitsLength = hits.data.hits.length;\n\n  if (hitsLength < 40) {\n    refs.loadMoreBtnEl.classList.add(\"is-hidden\");\n    iziToast.info({message: \"We're sorry, but you've reached the end of search results.\"});\n    return;\n  }\n}\n\nfunction appendPhotoCardMarkup(getImg) {\n  const img = getImg.data.hits;\n  console.log(img)\n\n  const photoCardMarkup = img.map(({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => `\n    <div class=\"photo-card\">\n      <a class=\"photo-link\" href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" width=\"356\" height=\"200\" />\n      </a>  \n      <div class=\"info\">\n        <p class=\"info-item\">\n          <b>Likes </br><span class=\"info-data\">${likes}</span></b>\n        </p>\n        <p class=\"info-item\">\n          <b>Views </br><span class=\"info-data\">${views}</span></b>\n        </p>\n        <p class=\"info-item\">\n          <b>Comments </br><span class=\"info-data\">${comments}</span></b>\n        </p>\n        <p class=\"info-item\">\n          <b>Downloads </br><span class=\"info-data\">${downloads}</span></b>\n        </p>\n      </div>      \n    </div>\n  `).join(\"\");\n\n  refs.galleryEl.insertAdjacentHTML(\"beforeend\", photoCardMarkup);\n  lightbox.refresh(); \n}\n\nfunction clearPhotoCardGallery() {\n  refs.galleryEl.innerHTML = \"\";\n}\n"],"names":["axios","keyApi","PixabayApiService","getImg","refs","pixabayApiService","lightbox","SimpleLightbox","onSearch","onLoadMore","e","totalHits","clearPhotoCardGallery","iziToast","appendPhotoCardMarkup","img","photoCardMarkup","largeImageURL","webformatURL","tags","likes","views","comments","downloads"],"mappings":"owBAEAA,EAAM,SAAS,QAAU,0BACzB,MAAMC,EAAS,qCAEA,MAAMC,CAAkB,CACrC,aAAc,CACZ,KAAK,YAAc,GACnB,KAAK,KAAO,CACb,CAED,MAAM,UAAW,CACf,MAAMC,EAAS,MAAMH,EAAM,IACzB,SAASC,OAAY,KAAK,wFAAwF,KAAK,MAC7H,EAEI,YAAK,cAAa,EACXE,CACR,CAED,eAAgB,CACd,KAAK,MAAQ,CACd,CAED,WAAY,CACV,KAAK,KAAO,CACb,CACH,CCrBA,MAAMC,EAAO,CACX,aAAc,SAAS,cAAc,cAAc,EACnD,cAAe,SAAS,cAAc,YAAY,EAClD,UAAW,SAAS,cAAc,UAAU,CAC9C,EAEMC,EAAoB,IAAIH,EAE9B,IAAII,EAAW,IAAIC,EAAe,YAAY,EAE9CH,EAAK,aAAa,iBAAiB,SAAUI,CAAQ,EACrDJ,EAAK,cAAc,iBAAiB,QAASK,CAAU,EAEvDL,EAAK,cAAc,UAAU,IAAI,WAAW,EAE5C,eAAeI,EAASE,EAAG,CACzBA,EAAE,eAAc,EAChBL,EAAkB,YAAcK,EAAE,cAAc,SAAS,YAAY,MAErE,MAAMN,EAAK,cAAc,UAAU,IAAI,WAAW,EAGlD,MAAMO,GADO,MAAMN,EAAkB,YACd,KAAK,UAE5B,GAAIM,EAAY,EAAG,CACjBP,EAAK,cAAc,UAAU,IAAI,WAAW,EAC5CQ,IACAC,EAAS,MAAM,CAAC,QAAS,0EAA0E,CAAC,EACpG,MACD,CAED,MAAMD,EAAqB,EAE3B,MAAMP,EAAkB,YACxB,MAAMA,EAAkB,SAAQ,EAAG,KAAKS,CAAqB,EAC7D,MAAMV,EAAK,cAAc,UAAU,OAAO,WAAW,EACrDS,EAAS,QAAQ,CAAC,QAAS,oBAAoBF,WAAmB,CAAC,CACrE,CAEA,eAAeF,GAAa,CAK1B,GAJA,MAAMJ,EAAkB,SAAQ,EAAG,KAAKS,CAAqB,GAChD,MAAMT,EAAkB,YACb,KAAK,KAAK,OAEjB,GAAI,CACnBD,EAAK,cAAc,UAAU,IAAI,WAAW,EAC5CS,EAAS,KAAK,CAAC,QAAS,4DAA4D,CAAC,EACrF,MACD,CACH,CAEA,SAASC,EAAsBX,EAAQ,CACrC,MAAMY,EAAMZ,EAAO,KAAK,KACxB,QAAQ,IAAIY,CAAG,EAEf,MAAMC,EAAkBD,EAAI,IAAI,CAAC,CAAE,cAAAE,EAAe,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAAK;AAAA;AAAA,oCAE5EN;AAAA,oBAChBC,WAAsBC;AAAA;AAAA;AAAA;AAAA,kDAIQC;AAAA;AAAA;AAAA,kDAGAC;AAAA;AAAA;AAAA,qDAGGC;AAAA;AAAA;AAAA,sDAGCC;AAAA;AAAA;AAAA;AAAA,GAInD,EAAE,KAAK,EAAE,EAEVnB,EAAK,UAAU,mBAAmB,YAAaY,CAAe,EAC9DV,EAAS,QAAO,CAClB,CAEA,SAASM,GAAwB,CAC/BR,EAAK,UAAU,UAAY,EAC7B"}