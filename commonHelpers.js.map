{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-service.js","../src/index.js"],"sourcesContent":["import axios from \"axios\";\n\naxios.defaults.baseURL = \"https://pixabay.com/api\";\nconst keyApi = \"24433477-a7717dfa51cf01b03daed8616\";\n\nexport default class PixabayApiService {\n  constructor() {\n    this.searchQuery = \"\";\n    this.page = 1;\n  }\n\n  async fetchImg() {\n    const getImg = await axios.get(\n      `/?key=${keyApi}&q=${this.searchQuery}&image_type=photo&orientation=horizontal&safesearch=true&per_page=40&page=${this.page}`,\n    );\n\n    return getImg;\n  }\n\n  incrementPage() {\n    this.page += 1;\n  }\n\n  resetPage() {\n    this.page = 1;\n  }\n}\n","import PixabayApiService from \"./js/pixabay-service\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\n  searchFormEl: document.querySelector(\".search-form\"),\n  loadMoreBtnEl: document.querySelector(\".load-more\"),\n  galleryEl: document.querySelector(\".gallery\"),\n};\n\nconst pixabayApiService = new PixabayApiService();\n\nlet lightbox = new SimpleLightbox(\".gallery a\");\n\nrefs.searchFormEl.addEventListener(\"submit\", onSearch);\nrefs.loadMoreBtnEl.addEventListener(\"click\", onLoadMore);\n\nrefs.loadMoreBtnEl.classList.add(\"is-hidden\");\n\nasync function onSearch(e) {\n  e.preventDefault();\n  pixabayApiService.searchQuery = e.currentTarget.elements.searchQuery.value.trim().toLowerCase();\n  if (pixabayApiService.searchQuery === \"\") {\n    await clearPhotoCardGallery();\n    await refs.loadMoreBtnEl.classList.add(\"is-hidden\");\n    iziToast.info({ message: \"please enter your request.\" });\n    return;\n  }\n\n  await refs.loadMoreBtnEl.classList.add(\"is-hidden\");\n  await pixabayApiService.resetPage();\n\n  const hits = await pixabayApiService.fetchImg();\n  const totalHits = hits.data.totalHits;\n\n  if (totalHits < 1) {\n    refs.loadMoreBtnEl.classList.add(\"is-hidden\");\n    clearPhotoCardGallery();\n    iziToast.error({message: \"Sorry, there are no images matching your search query. Please try again.\"});\n    return;\n  }\n  \n  await clearPhotoCardGallery();\n  await appendPhotoCardMarkup(hits);\n  await refs.loadMoreBtnEl.classList.remove(\"is-hidden\");\n  iziToast.success({message: `Hooray! We found ${totalHits} images.`});\n}\n\nasync function onLoadMore() {\n  await pixabayApiService.incrementPage();\n\n  const hits = await pixabayApiService.fetchImg();\n  const hitsLength = hits.data.hits.length;\n  \n  await appendPhotoCardMarkup(hits);  \n  \n  if (hitsLength < 40) {\n    refs.loadMoreBtnEl.classList.add(\"is-hidden\");\n    iziToast.info({message: \"We're sorry, but you've reached the end of search results.\"});\n    return;\n  }\n}\n\nfunction appendPhotoCardMarkup(getImg) {\n  const img = getImg.data.hits;\n\n  const photoCardMarkup = img.map(({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => `\n    <div class=\"photo-card\">\n      <a class=\"photo-link\" href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" width=\"356\" height=\"200\" />\n      </a>  \n      <div class=\"info\">\n        <p class=\"info-item\">\n          <b>Likes </br><span class=\"info-data\">${likes}</span></b>\n        </p>\n        <p class=\"info-item\">\n          <b>Views </br><span class=\"info-data\">${views}</span></b>\n        </p>\n        <p class=\"info-item\">\n          <b>Comments </br><span class=\"info-data\">${comments}</span></b>\n        </p>\n        <p class=\"info-item\">\n          <b>Downloads </br><span class=\"info-data\">${downloads}</span></b>\n        </p>\n      </div>      \n    </div>\n  `).join(\"\");\n\n  refs.galleryEl.insertAdjacentHTML(\"beforeend\", photoCardMarkup);\n  lightbox.refresh(); \n}\n\nfunction clearPhotoCardGallery() {\n  refs.galleryEl.innerHTML = \"\";\n  // pixabayApiService.resetSearchQuery();\n}\n"],"names":["axios","keyApi","PixabayApiService","refs","pixabayApiService","lightbox","SimpleLightbox","onSearch","onLoadMore","e","clearPhotoCardGallery","iziToast","hits","totalHits","appendPhotoCardMarkup","hitsLength","getImg","photoCardMarkup","largeImageURL","webformatURL","tags","likes","views","comments","downloads"],"mappings":"owBAEAA,EAAM,SAAS,QAAU,0BACzB,MAAMC,EAAS,qCAEA,MAAMC,CAAkB,CACrC,aAAc,CACZ,KAAK,YAAc,GACnB,KAAK,KAAO,CACb,CAED,MAAM,UAAW,CAKf,OAJe,MAAMF,EAAM,IACzB,SAASC,OAAY,KAAK,wFAAwF,KAAK,MAC7H,CAGG,CAED,eAAgB,CACd,KAAK,MAAQ,CACd,CAED,WAAY,CACV,KAAK,KAAO,CACb,CACH,CCpBA,MAAME,EAAO,CACX,aAAc,SAAS,cAAc,cAAc,EACnD,cAAe,SAAS,cAAc,YAAY,EAClD,UAAW,SAAS,cAAc,UAAU,CAC9C,EAEMC,EAAoB,IAAIF,EAE9B,IAAIG,EAAW,IAAIC,EAAe,YAAY,EAE9CH,EAAK,aAAa,iBAAiB,SAAUI,CAAQ,EACrDJ,EAAK,cAAc,iBAAiB,QAASK,CAAU,EAEvDL,EAAK,cAAc,UAAU,IAAI,WAAW,EAE5C,eAAeI,EAASE,EAAG,CAGzB,GAFAA,EAAE,eAAc,EAChBL,EAAkB,YAAcK,EAAE,cAAc,SAAS,YAAY,MAAM,OAAO,cAC9EL,EAAkB,cAAgB,GAAI,CACxC,MAAMM,EAAqB,EAC3B,MAAMP,EAAK,cAAc,UAAU,IAAI,WAAW,EAClDQ,EAAS,KAAK,CAAE,QAAS,4BAA8B,CAAA,EACvD,MACD,CAED,MAAMR,EAAK,cAAc,UAAU,IAAI,WAAW,EAClD,MAAMC,EAAkB,YAExB,MAAMQ,EAAO,MAAMR,EAAkB,WAC/BS,EAAYD,EAAK,KAAK,UAE5B,GAAIC,EAAY,EAAG,CACjBV,EAAK,cAAc,UAAU,IAAI,WAAW,EAC5CO,IACAC,EAAS,MAAM,CAAC,QAAS,0EAA0E,CAAC,EACpG,MACD,CAED,MAAMD,EAAqB,EAC3B,MAAMI,EAAsBF,CAAI,EAChC,MAAMT,EAAK,cAAc,UAAU,OAAO,WAAW,EACrDQ,EAAS,QAAQ,CAAC,QAAS,oBAAoBE,WAAmB,CAAC,CACrE,CAEA,eAAeL,GAAa,CAC1B,MAAMJ,EAAkB,gBAExB,MAAMQ,EAAO,MAAMR,EAAkB,WAC/BW,EAAaH,EAAK,KAAK,KAAK,OAIlC,GAFA,MAAME,EAAsBF,CAAI,EAE5BG,EAAa,GAAI,CACnBZ,EAAK,cAAc,UAAU,IAAI,WAAW,EAC5CQ,EAAS,KAAK,CAAC,QAAS,4DAA4D,CAAC,EACrF,MACD,CACH,CAEA,SAASG,EAAsBE,EAAQ,CAGrC,MAAMC,EAFMD,EAAO,KAAK,KAEI,IAAI,CAAC,CAAE,cAAAE,EAAe,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAAK;AAAA;AAAA,oCAE5EN;AAAA,oBAChBC,WAAsBC;AAAA;AAAA;AAAA;AAAA,kDAIQC;AAAA;AAAA;AAAA,kDAGAC;AAAA;AAAA;AAAA,qDAGGC;AAAA;AAAA;AAAA,sDAGCC;AAAA;AAAA;AAAA;AAAA,GAInD,EAAE,KAAK,EAAE,EAEVrB,EAAK,UAAU,mBAAmB,YAAac,CAAe,EAC9DZ,EAAS,QAAO,CAClB,CAEA,SAASK,GAAwB,CAC/BP,EAAK,UAAU,UAAY,EAE7B"}